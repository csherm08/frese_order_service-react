(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1509:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>i,_:()=>l});var n=r(5155),o=r(2115);function a(e){try{let t={productId:e.productId,price:e.price,product_size_id:e.product_size_id||null};if(e.selections&&Object.keys(e.selections).length>0){for(let[r,n]of(t.selections=[],Object.entries(e.selections)))t.selections.push("".concat(r,": ").concat(n.value));t.selections.sort()}if(e.add_ons&&Object.keys(e.add_ons).length>0){for(let[r,n]of(t.add_ons=[],Object.entries(e.add_ons)))if(Array.isArray(n)){let e=r.split("-")[0];n.forEach(r=>{r.value&&t.add_ons.push("".concat(e,": ").concat(r.value))})}t.add_ons.sort()}return JSON.stringify(t)}catch(t){return console.error("Error generating composite key:",t),JSON.stringify({productId:e.productId,product_size_id:e.product_size_id||null})}}var s=r(1886);let c=(0,o.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,o.useState)([]),[l,d]=(0,o.useState)(null),[u,f]=(0,o.useState)(!1),[h,m]=(0,o.useState)([]);(0,o.useEffect)(()=>{let e=localStorage.getItem("cart"),t=localStorage.getItem("cartMode");if(e)try{let r=JSON.parse(e);if(i(r),r.length>0&&t)try{d(JSON.parse(t))}catch(e){console.error("Failed to load cart mode:",e)}else 0===r.length&&d(null)}catch(e){console.error("Failed to load cart:",e)}else if(t){try{let e=JSON.parse(t);console.log("[CartContext] Found saved mode but no cart items, clearing mode:",e)}catch(e){console.error("Failed to parse saved mode:",e)}d(null)}(0,s.Nh)().then(e=>{m(e),f(!0)}).catch(e=>{console.error("Failed to fetch product types:",e),f(!0)})},[]),(0,o.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(r)),l?localStorage.setItem("cartMode",JSON.stringify(l)):localStorage.removeItem("cartMode")},[r,l]);let p=(e,t)=>0===r.length||!e||e.type===t.type&&("special"!==e.type||"special"!==t.type||e.specialId===t.specialId),y=e=>{i(t=>{let r=t.filter((t,r)=>r!==e);return 0===r.length&&d(null),r})},g=e=>{let t=e.price;return e.selections&&Object.values(e.selections).forEach(e=>{e.cost&&(t+=e.cost)}),e.add_ons&&Object.values(e.add_ons).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{e.cost&&(t+=e.cost)})}),t},v=e=>{let t=h.find(e=>"Bread"===e.name);return!t||e.typeId!==t.id},b=(0,o.useMemo)(()=>r.reduce((e,t)=>e+g(t)*t.quantity,0),[r]),x=(0,o.useMemo)(()=>{let e=0;for(let t of r)v(t)&&(e+=g(t)*t.quantity*.08);return Math.round(100*e)/100},[r,h]);return(0,n.jsx)(c.Provider,{value:{items:r,cartMode:l,addItem:(e,t)=>(console.log("[CartContext] addItem called:",{item:{productId:e.productId,product_name:e.product_name},mode:t,currentCartMode:l,currentItemsCount:r.length,modesMatch:p(l,t)}),p(l,t))?(l||(console.log("[CartContext] Setting cart mode:",t),d(t)),i(t=>{let r=function(e,t){let r=a(t);return e.findIndex(e=>a(e)===r)}(t,e);return r>=0?t.map((t,n)=>n===r?{...t,quantity:t.quantity+e.quantity}:t):[...t,e]}),!0):(console.warn("[CartContext] Mode conflict detected:",{cartMode:l,requestedMode:t}),!1),removeItem:y,updateQuantity:(e,t)=>{if(t<=0){y(e);return}i(r=>{let n=r.map((r,n)=>n===e?{...r,quantity:t}:r);return 0===n.length&&d(null),n})},clearCart:()=>{i([]),d(null),localStorage.removeItem("cart"),localStorage.removeItem("cartMode")},switchMode:(e,t)=>{i(t?[t]:[]),d(e)},subtotal:b,tax:x,total:b+x,isLoaded:u},children:t})}function l(){let e=(0,o.useContext)(c);if(!e)throw Error("useCart must be used within CartProvider");return e}},1886:(e,t,r)=>{"use strict";r.d(t,{AP:()=>d,N8:()=>l,Nh:()=>a,f:()=>c,fM:()=>i,j0:()=>o,qP:()=>u,z8:()=>s});let n="https://frese-bakery-backend-app-504689514656.us-east1.run.app/api";async function o(){let e=await fetch("".concat(n,"/activeProductsAndSizesIncludingSpecials"));if(!e.ok)throw Error("Failed to fetch products");return e.json()}async function a(){let e=await fetch("".concat(n,"/products/types"));if(!e.ok)throw Error("Failed to fetch product types");return e.json()}async function s(){let e=await fetch("".concat(n,"/activeSpecials?activeOnly=true"));if(!e.ok)throw Error("Failed to fetch specials");return e.json()}async function c(e){let t=await fetch("".concat(n,"/stripe/intent"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e})});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Failed to create payment intent"}))).error||"Failed to create payment intent");let r=await t.json();return{clientSecret:r.client_secret||r.clientSecret,...r}}async function i(e,t){let r=await fetch("".concat(n,"/processOrderAndPay"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:e,paymentIntentInfo:t})});if(!r.ok)throw Error((await r.json()).error||"Failed to process order");return r.json()}async function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=await fetch("".concat(n,"/orders/availableTimes/").concat(e));if(!t.ok)throw Error("Failed to fetch regular timeslots");return t.json()}async function d(e){let t=await fetch("".concat(n,"/orders/availableSpecialTimes/").concat(e));if(!t.ok)throw Error("Failed to fetch special timeslots");return t.json()}async function u(e){let t=await fetch("".concat(n,"/unsubscribe"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!t.ok)throw Error("Failed to unsubscribe");return t.json()}},3999:(e,t,r)=>{"use strict";r.d(t,{Yq:()=>c,cn:()=>a,qj:()=>d,r6:()=>l,vv:()=>s});var n=r(2596),o=r(9688);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,n.$)(t))}function s(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function c(e){return("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}function i(e){return("string"==typeof e?new Date(e):e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function l(e){return"".concat(c(e)," at ").concat(i(e))}function d(e,t){let r="string"==typeof e?new Date(e):e,n="string"==typeof t?new Date(t):t,o=r.toDateString()===n.toDateString(),a=e=>{let t=e.getDate(),r=["th","st","nd","rd"][t%10>3?0:t%100-t%10!=10?t%10:0];return e.toLocaleDateString("en-US",{month:"long",day:"numeric"}).replace(/\d+/,t+r)};return o?"".concat(a(r)," ").concat(i(r)," - ").concat(i(n)):"".concat(a(r)," ").concat(i(r)," - ").concat(a(n)," ").concat(i(n))}},5499:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var n=r(5155),o=r(6874),a=r.n(o),s=r(7809);let c=(0,r(9946).A)("menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var i=r(1509),l=r(7168),d=r(8145);function u(){let{items:e}=(0,i._)(),t=e.reduce((e,t)=>e+t.quantity,0);return(0,n.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,n.jsxs)("div",{className:"container flex h-16 items-center justify-between px-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-6",children:[(0,n.jsx)(a(),{href:"/",className:"flex items-center space-x-2",children:(0,n.jsx)("div",{className:"text-2xl font-bold text-primary",children:"Frese's Bakery"})}),(0,n.jsxs)("nav",{className:"hidden md:flex gap-6 items-center",children:[(0,n.jsx)(a(),{href:"/",className:"text-sm font-medium transition-colors hover:text-primary",children:"Home"}),(0,n.jsx)(a(),{href:"/order",children:(0,n.jsx)(l.$,{size:"sm",className:"font-medium",children:"Order Now"})}),(0,n.jsx)(a(),{href:"/catering",className:"text-sm font-medium transition-colors hover:text-primary",children:"Catering"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(a(),{href:"/cart",children:(0,n.jsxs)(l.$,{variant:"outline",size:"icon",className:"relative",children:[(0,n.jsx)(s.A,{className:"h-5 w-5"}),t>0&&(0,n.jsx)(d.E,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full p-0 flex items-center justify-center",children:t})]})}),(0,n.jsx)(l.$,{variant:"ghost",size:"icon",className:"md:hidden",children:(0,n.jsx)(c,{className:"h-5 w-5"})})]})]})})}},5688:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_188709",variable:"__variable_188709"}},5918:(e,t,r)=>{Promise.resolve().then(r.bind(r,5499)),Promise.resolve().then(r.bind(r,1509)),Promise.resolve().then(r.t.bind(r,5688,23)),Promise.resolve().then(r.t.bind(r,9432,23)),Promise.resolve().then(r.t.bind(r,9324,23)),Promise.resolve().then(r.bind(r,6671))},7168:(e,t,r)=>{"use strict";r.d(t,{$:()=>l,r:()=>i});var n=r(5155),o=r(2115),a=r(9708),s=r(2085),c=r(3999);let i=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,t)=>{let{className:r,variant:o,size:s,asChild:l=!1,...d}=e,u=l?a.DX:"button";return(0,n.jsx)(u,{className:(0,c.cn)(i({variant:o,size:s,className:r})),ref:t,...d})});l.displayName="Button"},7809:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(9946).A)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},8145:(e,t,r)=>{"use strict";r.d(t,{E:()=>c});var n=r(5155);r(2115);var o=r(2085),a=r(3999);let s=(0,o.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:r,...o}=e;return(0,n.jsx)("div",{className:(0,a.cn)(s({variant:r}),t),...o})}},9324:()=>{},9432:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}}},e=>{var t=t=>e(e.s=t);e.O(0,[261,455,874,671,441,684,358],()=>t(5918)),_N_E=e.O()}]);