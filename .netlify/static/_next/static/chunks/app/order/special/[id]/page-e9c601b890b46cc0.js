(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{2741:(e,s,t)=>{Promise.resolve().then(t.bind(t,8804))},5695:(e,s,t)=>{"use strict";var l=t(8999);t.o(l,"useParams")&&t.d(s,{useParams:function(){return l.useParams}}),t.o(l,"useRouter")&&t.d(s,{useRouter:function(){return l.useRouter}})},8804:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var l=t(5155),a=t(2115),r=t(5695),c=t(8482),i=t(7168),n=t(1154),d=t(7550),o=t(7809),m=t(9074),u=t(4616),h=t(1886),p=t(3999),x=t(9505),g=t(7092),j=t(6874),f=t.n(j),N=t(1509),y=t(6671),v=t(6559);function w(){let e=parseInt((0,r.useParams)().id),[s,t]=(0,a.useState)(null),[j,w]=(0,a.useState)(!0),[b,C]=(0,a.useState)(null),[_,A]=(0,a.useState)(!1),[k,I]=(0,a.useState)(null),{items:S,addItem:O,cartMode:P,switchMode:E}=(0,N._)(),M=e=>{if(!s){console.error("Cannot add product: special is null"),y.o.error("Error: Special information is missing");return}let t={productId:e.id,product_name:e.title,quantity:1,price:e.special_price||e.price,product_size_id:null,selections:{},add_ons:{},typeId:e.typeId,product:e};console.log("Attempting to add item to cart:",{cartItem:t,mode:{type:"special",specialId:s.id,specialName:s.name},currentCartMode:P,currentItems:S}),O(t,{type:"special",specialId:s.id,specialName:s.name})?y.o.success("Added ".concat(e.title," to cart")):(console.error("[SpecialOrderPage] Failed to add item to cart. Showing conflict dialog:",{cartMode:P,requestedMode:{type:"special",specialId:s.id,specialName:s.name},itemsCount:S.length,cartItem:t}),I(t),A(!0),console.log("[SpecialOrderPage] Dialog state set:",{showModeConflictDialog:!0,pendingCartItem:t}))},D=e=>{!function(e){let s=!!(e.product_sizes&&e.product_sizes.length>0),t=!!(e.product_selection_values&&Object.keys(e.product_selection_values).length>0),l=!!(e.product_add_on_values&&Object.keys(e.product_add_on_values).length>0);return s||t||l}(e)?M(e):C(e)};async function U(){try{let s=(await (0,h.z8)()).find(s=>s.id===e);t(s||null)}catch(e){console.error("Failed to load special:",e)}finally{w(!1)}}if((0,a.useEffect)(()=>{U()},[e]),(0,a.useEffect)(()=>{_&&console.log("[SpecialOrderPage] Dialog should be visible:",{showModeConflictDialog:_,hasPendingCartItem:!!k,cartMode:P,itemsCount:S.length})},[_,k,P,S.length]),j)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,l.jsx)(n.A,{className:"h-8 w-8 animate-spin text-primary"})});if(!s)return(0,l.jsx)("div",{className:"container px-4 py-8",children:(0,l.jsxs)("div",{className:"text-center space-y-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Special Not Found"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"This special may no longer be available."}),(0,l.jsx)(f(),{href:"/order",children:(0,l.jsxs)(i.$,{children:[(0,l.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Back to Order"]})})]})});let R=s.products||[],$=S.reduce((e,s)=>e+s.quantity,0);return(0,l.jsxs)("div",{className:"container px-4 py-8",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(f(),{href:"/order",children:(0,l.jsxs)(i.$,{variant:"ghost",className:"gap-2",children:[(0,l.jsx)(d.A,{className:"h-4 w-4"}),"Back"]})}),$>0&&(0,l.jsx)(f(),{href:"/cart",children:(0,l.jsxs)(i.$,{className:"gap-2",children:[(0,l.jsx)(o.A,{className:"h-4 w-4"}),"View Cart (",$,")"]})})]}),(0,l.jsxs)("div",{className:"relative rounded-xl overflow-hidden",children:[s.photoUrl&&(0,l.jsxs)("div",{className:"absolute inset-0",children:[(0,l.jsx)(g.A,{src:s.photoUrl,alt:s.name,fill:!0,containerClassName:"w-full h-full",priority:!0}),(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"})]}),(0,l.jsx)("div",{className:"relative ".concat(s.photoUrl?"text-white py-16 px-6":"py-8"),children:(0,l.jsxs)("div",{className:"max-w-2xl",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold mb-2",children:s.name}),s.description&&(0,l.jsx)("p",{className:"text-lg ".concat(s.photoUrl?"text-gray-200":"text-muted-foreground"," mb-4"),children:s.description}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm ".concat(s.photoUrl?"text-gray-300":"text-muted-foreground"),children:[(0,l.jsx)(m.A,{className:"h-4 w-4"}),(0,l.jsxs)("span",{children:["Available: ",(0,p.qj)(s.start,s.end)]})]})]})})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold",children:"Available Items"}),R.length>0?(0,l.jsx)("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:R.map(e=>(0,l.jsxs)(c.Zp,{className:"flex flex-col hover:shadow-lg transition-shadow",children:[(0,l.jsx)(c.aR,{className:"p-0",children:e.photoUrl?(0,l.jsx)(g.A,{src:e.photoUrl,alt:e.title,fill:!0,containerClassName:"w-full h-48 rounded-t-lg",className:"rounded-t-lg"}):(0,l.jsx)("div",{className:"w-full h-48 bg-gradient-to-br from-amber-100 to-orange-100 rounded-t-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-4xl",children:"\uD83E\uDD56"})})}),(0,l.jsxs)(c.Wu,{className:"flex-1 pt-4",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg mb-1",children:e.title}),e.description&&(0,l.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-2",children:e.description}),(0,l.jsx)("p",{className:"font-bold text-lg text-primary",children:(0,p.vv)(e.price)})]}),(0,l.jsx)(c.wL,{className:"pt-0",children:(0,l.jsxs)(i.$,{className:"w-full",onClick:()=>D(e),children:[(0,l.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Add to Cart"]})})]},e.id))}):(0,l.jsx)(c.Zp,{children:(0,l.jsx)(c.Wu,{className:"py-12 text-center",children:(0,l.jsx)("p",{className:"text-muted-foreground",children:"No products available for this special yet."})})})]}),$>0&&(0,l.jsx)("div",{className:"fixed bottom-4 left-4 right-4 md:hidden",children:(0,l.jsx)(f(),{href:"/cart",children:(0,l.jsxs)(i.$,{className:"w-full h-14 text-lg shadow-lg",children:[(0,l.jsx)(o.A,{className:"mr-2 h-5 w-5"}),"View Cart (",$," items)"]})})})]}),b&&s&&(0,l.jsx)(x.A,{product:b,open:!0,onClose:()=>C(null),mode:{type:"special",specialId:s.id,specialName:s.name}}),(0,l.jsx)(v.Lt,{open:_,onOpenChange:e=>{console.log("[SpecialOrderPage] Dialog onOpenChange:",e),e?A(!0):(A(!1),I(null))},children:(0,l.jsxs)(v.EO,{children:[(0,l.jsxs)(v.wd,{children:[(0,l.jsx)(v.r7,{children:"Switch Cart Mode?"}),(0,l.jsx)(v.$v,{children:(P&&s?"regular"===P.type?'You currently have items from the Regular Menu in your cart. Adding items from "'.concat(s.name,'" will clear your cart.'):"special"===P.type?'You currently have items from "'.concat(P.specialName,'" in your cart. Adding items from "').concat(s.name,'" will clear your cart.'):"":"")||"Adding this item will clear your current cart."})]}),(0,l.jsxs)(v.ck,{children:[(0,l.jsx)(v.Zr,{onClick:()=>{A(!1),I(null)},children:"Keep Current Cart"}),(0,l.jsx)(v.Rx,{onClick:()=>{k&&s&&(E({type:"special",specialId:s.id,specialName:s.name},k),y.o.success("Cart cleared. Added ".concat(k.product_name," to cart"))),A(!1),I(null)},children:"Clear Cart & Add Item"})]})]})})]})}},9074:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[455,874,671,139,385,944,91,886,441,684,358],()=>s(2741)),_N_E=e.O()}]);